<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="metapsyTools">
<title>Get Started • metapsyTools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Fira%20Sans-0.4.1/font.css" rel="stylesheet">
<link href="../deps/_Fira%20Code-0.4.1/font.css" rel="stylesheet">
<link href="../deps/_Roboto%20Slab-0.4.1/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get Started">
<meta property="og:description" content="metapsyTools">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script src="extra_script_header.js"></script>
</head>
<body>
<p>,<link rel="stylesheet" href="extra.css"></p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metapsyTools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/metapsyTools.html">Get Started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-documentation">Documentation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-documentation">
    <a class="dropdown-item" href="../reference/index.html">Function Reference</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/web/installation.html">Installation Guide</a>
    <a class="dropdown-item" href="../articles/web/look_inside.html">A Look Inside</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/metapsy-project/metapsyTools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get Started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/metapsy-project/metapsyTools/blob/HEAD/vignettes/metapsyTools.Rmd" class="external-link"><code>vignettes/metapsyTools.Rmd</code></a></small>
      <div class="d-none name"><code>metapsyTools.Rmd</code></div>
    </div>

    
    
<p><img src="https://tools.metapsy.org/figures/arrow.jpg" style="width: 100%; border-radius: 5px; box-shadow: 0px 0px 5px;"></p>
<p><strong>This article showcases core functionalities of the package,
and how to apply them in practice.</strong></p>
<p><br></p>
<div class="section level2">
<h2 id="introduction">
<img src="https://tools.metapsy.org/figures/rocket.svg" width="30px" style="padding-right: 5px;">
Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr>
<p>The <code>metapsyTools</code> package is part of the <a href="https://www.metapsy.org" class="external-link"><strong>Metapsy</strong></a> project.
Functions included in the package can be used to run meta-analyses of
Metapsy <a href="https://docs.metapsy.org/databases/" class="external-link">databases</a>, or
of databases that adhere to the same <a href="https://docs.metapsy.org/data-preparation/format/" class="external-link">data
standard</a>, “out of the box” using R.</p>
<p>The package also contains a set of tools that can be used to prepare
meta-analytic data sets based on the Metapsy data standard, and to
calculate effect sizes (Hedges’ <span class="math inline">\(g\)</span>
and risk ratios, <span class="math inline">\(RR\)</span>).</p>
<p>The package consists of <strong>two modules</strong>:</p>
<ol style="list-style-type: decimal">
<li>A module to check the data format and calculate effect sizes for all
possible study comparisons (<strong>preparation</strong>
<strong>module</strong>);</li>
<li>A module to select relevant comparisons for a specific
meta-analysis, calculate the results (including subgroup,
meta-regression, and publication bias analyses), and generate tables
(<strong>analysis</strong> <strong>module</strong>).</li>
</ol>
<p>The idea is to use the two modules in different contexts. For
example, the <strong>preparation</strong> module can be used every time
the database is updated to gather all information, calculate effect
sizes, and bring the data into a format suitable for further
analyses.</p>
<p>Prepared data sets that follow the <a href="https://docs.metapsy.org/data-preparation/format/" class="external-link"><strong>Metapsy
data standard</strong></a> build the basis for the
<strong>analysis</strong> module. Researchers simply have to filter out
the comparisons that are relevant for the investigation, and can then
use functions of the package to run a full meta-analysis, including
sensitivity and subgroup analyses.</p>
<p><br></p>
<p><img src="overview.png" width="685"></p>
<div style="background-color: #f1f3f5 !important; padding: 25px; border-radius: 5px; color: gray; box-shadow: 0px 0px 5px;">
<p><strong>Important</strong>: The preparation module requires a
familiarity with the general structure of the database, as well as
intermediate-level knowledge of R and the <code>metapsyTools</code>
package itself, in order to diagnose (potential) issues. We advise that
the preparation step (i.e. checking the data format and calculating
effect sizes each time the database is updated) should be conducted by a
person with some proficiency in R &amp; data wrangling. The analysis
module, on the other hand, should be usable by all researchers.</p>
</div>
<p><br></p>
<p>The companion package of <code>metapsyTools</code> is <a href="data.metapsy.org"><code>metapsyData</code></a>. Using
<code>metapsyData</code> meta-analytic databases can be automatically
downloaded into your R environment. Databases retrieved using
<code>metapsyData</code> can directly be analyzed using
<code>metapsyTools</code>.</p>
<p><strong>If your goal is to analyze existing databases included in
Metapsy, only the analysis module in <code>metapsyTools</code> is
relevant to you. Click</strong> <a href="#the-analysis-module">here</a>
<strong>to navigate directly to the analysis module
section.</strong></p>
<p><br></p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="the-preparation-module">
<img src="https://tools.metapsy.org/figures/preparation.svg" width="30px" style="padding-right: 5px;">
The Preparation Module<a class="anchor" aria-label="anchor" href="#the-preparation-module"></a>
</h2>
<hr>
<p>The preparation module in <code>metapsyTools</code> allows to:</p>
<ul>
<li>check if the classes of variables in the imported data set are set
as required, using the <a href="https://tools.metapsy.org/reference/checkdataformat" class="external-link">checkDataFormat</a>
function.</li>
<li>check for formatting conflicts which have to be resolved prior to
any further steps, using the <a href="https://tools.metapsy.org/reference/checkdataformat" class="external-link">checkConflicts</a>
function.</li>
<li>calculate Hedges’ <span class="math inline">\(g\)</span> and/or risk
ratios (<span class="math inline">\(RR\)</span>) for each comparison,
provided suitable data is available, and generate a data set ready for
meta-analyses, using the <a href="https://tools.metapsy.org/reference/calculateeffectsizes" class="external-link">calculateEffectSizes</a>
function.</li>
</ul>
<p><br></p>
<div class="section level3">
<h3 id="required-data-structure">Required Data Structure<a class="anchor" aria-label="anchor" href="#required-data-structure"></a>
</h3>
<p>For your own convenience, it is highly advised to
<strong>strictly</strong> follow some data formatting rules prior to
importing a data set for effect size calculations. If all of these rules
are followed closely, it minimizes the risk of receiving error messages,
producing conflicts, etc.</p>
<p>A detailed description of the preferred data structure can be found
in the <a href="https://docs.metapsy.org/data-preparation/format/" class="external-link"><strong>Metapsy
documentation</strong></a>. The <code>metapsyTools</code> package also
includes a “toy” data set called <a href="https://tools.metapsy.org/reference/depressionpsyctr" class="external-link"><code>depressionPsyCtr</code></a>,
which has already been pre-formatted to follow the required data
format.</p>
<p>To use the data preparation module (i.e. calculate effect sizes),
<strong>study design (I)</strong> and <strong>effect size data variables
(II)</strong> must be included in the data set.</p>
<p><br></p>
<div class="section level4">
<h4 id="study-design-variables-i">Study Design Variables (I)<a class="anchor" aria-label="anchor" href="#study-design-variables-i"></a>
</h4>
<ul>
<li>
<strong><code>study</code></strong>: The study name, formatted as
“last name of the first author”, “year”
(e.g. <code>"Smith, 2011"</code>).</li>
<li>
<strong><code>condition_arm1</code></strong>: Condition in the first
trial arm. The condition name is standardized to ensure comparability
across trials (e.g. <code>cbt</code> for all trial arms that employed
cognitive-behavioral psychotherapy).</li>
<li>
<strong><code>condition_arm2</code></strong>: Condition in the
second trial arm. The condition name is standardized to ensure
comparability across trials (e.g. <code>wlc</code> for all trial arms
that employed a waitlist control group).</li>
<li>
<strong><code>multi_arm1</code></strong>: In multiarm trials, this
variable provides a “specification” of the type of treatment used in the
first arm. This variable is set to <code>NA</code> (missing) when the
study was not a multiarm trial. For example, if a multiarm trial
employed two types of CBT interventions, face-to-face and
Internet-based, this variable would be set to <code>f2f</code> and
<code>Internet</code>, respectively.</li>
<li>
<strong><code>multi_arm2</code></strong>: In multiarm trials, this
variable provides a “specification” of the type of treatment used in the
second arm. This variable is set to <code>NA</code> (missing) when the
study was not a multiarm trial. For example, if a multiarm trial
employed two types of control groups, waitlist and placebo, this
variable would be set to <code>wl</code> and <code>plac</code>,
respectively.</li>
<li>
<strong><code>outcome_type</code></strong>: This variable encodes
the type of outcome that builds the basis of the comparison,
e.g. <code>"response"</code>, <code>"remission"</code> or
<code>"deterioration"</code>. This is variable is particularly relevant
for dichotomous effect size data, because it indicates what the event
counts refer to. The <code>"msd"</code> factor level is used for
outcomes expressed in means and standard deviations.</li>
<li>
<strong><code>instrument</code></strong>: This variable describes
the instrument through which the relevant outcome was measured.</li>
<li>
<strong><code>time</code></strong>: The measurement point at which
the outcome was obtained (e.g. <code>post</code> or
<code>follow-up</code>).</li>
<li>
<strong><code>time_weeks</code></strong>: The measurement point at
which the outcome was obtained, in weeks after randomization (set to
<code>NA</code> if this information was not available).</li>
<li>
<strong><code>rating</code></strong>: This variable encodes if the
reported outcome was self-reported (<code>"self-report"</code>) or
clinician-rated (<code>"clinician"</code>).</li>
</ul>
<p><br></p>
</div>
<div class="section level4">
<h4 id="effect-size-data-variables-ii">Effect Size Data Variables (II)<a class="anchor" aria-label="anchor" href="#effect-size-data-variables-ii"></a>
</h4>
<p>Each Metapsy database also contains variables in which the (raw or
pre-calculated) effect size data is stored. In each row, one of the
following variable groups (a) to (d) are specified, depending on the
type of outcome data reported in the paper. <strong>The rest of the
variable groups will contain <code>NA</code> in that row.</strong></p>
<p><br></p>
<div style="background-color: #f1f3f5 !important; padding: 25px; border-radius: 5px; color: gray; box-shadow: 0px 0px 5px;">
<p>When preparing the effect size data, it is very important that each
row only has data provided for one variable group (as defined below),
while the other variable groups are <code>NA</code> (i.e., have missing
values). Otherwise, the <a href="https://tools.metapsy.org/reference/calculateeffectsizes" class="external-link"><code>calculateEffectSizes</code></a>
function that we use later will not know which type of effect size
should be calculated.</p>
</div>
<p><br></p>
<p><strong>(a)</strong> <strong>Continuous Outcome Data</strong></p>
<ul>
<li>
<strong><code>mean_arm1</code></strong>: Mean of the outcome in the
first arm at the measured time point.</li>
<li>
<strong><code>mean_arm2</code></strong>: Mean of the outcome in the
second arm at the measured time point.</li>
<li>
<strong><code>sd_arm1</code></strong>: Standard deviation of the
outcome in the first arm at the measured time point.</li>
<li>
<strong><code>sd_arm2</code></strong>: Standard deviation of the
outcome in the second arm at the measured time point.</li>
<li>
<strong><code>n_arm1</code></strong>: Sample size in the first trial
arm.</li>
<li>
<strong><code>n_arm2</code></strong>: Sample size in the second
trial arm.</li>
</ul>
<p><br></p>
<p><strong>(b) Change Score Data</strong></p>
<ul>
<li>
<strong><code>mean_change_arm1</code></strong>: Mean score change
between baseline and the measured time point in the first arm.</li>
<li>
<strong><code>mean_change_arm2</code></strong>: Mean score change
between baseline and the measured time point in the second arm.</li>
<li>
<strong><code>sd_change_arm1</code></strong>: Standard deviation of
the mean change in the first arm.</li>
<li>
<strong><code>sd_change_arm2</code></strong>: Standard deviation of
the mean change in the second arm.</li>
<li>
<strong><code>n_change_arm1</code></strong>: Sample size in the
first trial arm.</li>
<li>
<strong><code>n_change_arm2</code></strong>: Sample size in the
second trial arm.</li>
</ul>
<p><br></p>
<p><strong>(c) Dichotomous Outcome Data (Response, Remission,
Deterioration, …)</strong></p>
<ul>
<li>
<strong><code>event_arm1</code></strong>: Number of events
(responders, remission, deterioration cases) in the first trial
arm.</li>
<li>
<strong><code>event_arm2</code></strong>: Number of events
(responders, remission, deterioration cases) in the second trial
arm.</li>
<li>
<strong><code>totaln_arm1</code></strong>: Sample size in the first
trial arm.</li>
<li>
<strong><code>totaln_arm2</code></strong>: Sample size in the second
trial arm.</li>
</ul>
<p><br></p>
<p><strong>(d) Pre-calculated Hedges’</strong> <span class="math inline">\(g\)</span></p>
<ul>
<li>
<strong><code>precalc_g</code></strong>: The pre-calculated value of
Hedges’ <span class="math inline">\(g\)</span> (small-sample bias
corrected standardized mean difference; <a href="https://journals.sagepub.com/doi/10.3102/10769986006002107" class="external-link">Hedges,
1981</a>).</li>
<li>
<strong><code>precalc_g_se</code></strong>: Standard error of <span class="math inline">\(g\)</span>, viz. <span class="math inline">\(\sqrt{V_g}\)</span>.</li>
</ul>
<p><br></p>
<p><strong>(d) Pre-calculated log-risk ratio</strong></p>
<ul>
<li>
<strong><code>precalc_log_rr</code></strong>: The pre-calculated
value of the log-risk ratio <span class="math inline">\(\log_{e}\text{RR}\)</span>, comparing events in
the first arm to events in the second arm.</li>
<li>
<strong><code>precalc_log_rr_se</code></strong>: The standard error
of the log-risk ratio <span class="math inline">\(\log_{e}\text{RR}\)</span>, comparing events in
the first arm to events in the second arm.</li>
</ul>
<p><br></p>
</div>
<div class="section level4">
<h4 id="additional-considerations">Additional Considerations<a class="anchor" aria-label="anchor" href="#additional-considerations"></a>
</h4>
<p>Metapsy databases also contain additional variables. These are used,
for example, to collect subject-specific information that is not
relevant for all indications. Nevertheless, there are several formatting
rules that all variables/columns follow:</p>
<ul>
<li>All variable names are in <a href="https://en.wikipedia.org/wiki/Snake_case?oldformat=true" class="external-link"><code>snake_case</code></a>.</li>
<li>Variable names start with a standard letter (<code>_</code> is not
allowed, <code>.</code> is only allowed for <code>metapsyTools</code>
variables).</li>
<li>Variable names do not contain special characters (like @, ğ).</li>
<li>Semicolons (<code>;</code>) are not used; neither as variable names
nor as cell content.</li>
<li>Character values contain no leading/trailing white spaces.</li>
<li>Missing values are encoded using <code>NA</code>.</li>
</ul>
<p><br></p>
</div>
</div>
<div class="section level3">
<h3 id="data-format-conflict-check">Data Format &amp; Conflict Check<a class="anchor" aria-label="anchor" href="#data-format-conflict-check"></a>
</h3>
<p>Once the data set has been pre-structured correctly,
<code>metapsyTools</code> allows you to check the required variable
format and control for potential formatting conflicts.</p>
<p>If the formatting rules above are followed, none of the default
behavior of the preparation module has to be changed. At first, one can
run <code>checkDataFormat</code>. As an illustration, we will use the <a href="https://tools.metapsy.org/reference/depressionpsyctr" class="external-link"><code>depressionPsyCtr</code></a>
data frame, a pre-installed “toy” data set which is directly available
after installing <code>metapsyTools</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load metapsyTools &amp; dplyr</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/metapsy-project/metapsyTools" class="external-link">metapsyTools</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>

<span class="co"># Load preinstalled "toy" dataset</span>
<span class="fu"><a href="../reference/Replacement-functions.html">data</a></span><span class="op">(</span><span class="st">"depressionPsyCtr"</span><span class="op">)</span>

<span class="co"># Check data format</span>
<span class="va">depressionPsyCtr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkDataFormat.html">checkDataFormat</a></span><span class="op">(</span><span class="va">depressionPsyCtr</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co"># - [OK] Data set contains all variables in 'must.contain'.</span>
<span class="co"># - [OK] 'study' has desired class character.</span>
<span class="co"># - [OK] 'condition_arm1' has desired class character.</span>
<span class="co"># [...]</span></code></pre>
<p>We see that the function has checked the required variables and their
class. If divergent, the function will also try to
<strong>convert</strong> the variable to the desired format.</p>
<p><br></p>
<div style="background-color: #f1f3f5 !important; padding: 25px; border-radius: 5px; color: gray; box-shadow: 0px 0px 5px;">
<p><strong>Required variables for unique IDs</strong>: To function
properly, the <code>metapsyTools</code> functions must be able to
generate a <em>unique</em> ID for each comparison. By default, this is
achieved by combining information of the <code>study</code>,
<code>condition_arm1</code>, <code>condition_arm2</code>,
<code>multi_arm1</code>, <code>multi_arm2</code>,
<code>outcome_type</code>, <code>instrument</code>, <code>time</code>,
<code>time_weeks</code>, <code>rating</code> variables. These variables
are included by default in the <code>must.contain</code> argument in the
<code>checkDataFormat</code> function. If all required variables are
detected, an <code>OK</code> message is returned; as is the case in our
example.</p>
</div>
<p><br></p>
<p>We can also check the data for potential formatting issues, using the
<code>checkConflicts</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">depressionPsyCtr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkConflicts.html">checkConflicts</a></span><span class="op">(</span><span class="va">depressionPsyCtr</span><span class="op">)</span> </code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># - [OK] No data format conflicts detected.</span></code></pre></div>
<p>In our case, no data format conflicts were detected. This is because
all the data were pre-structured correctly. If data conflicts exist, the
output looks similar to this:</p>
<pre><code><span class="co"># - [!] Data format conflicts detected!</span>
<span class="co"># ID conflicts </span>
<span class="co"># - check if variable(s) study create(s) unique assessment point IDs </span>
<span class="co"># - check if specification uniquely identifies all trial arms in multiarm trials </span>
<span class="co"># --------------------</span>
<span class="co"># Abas, 2018</span>
<span class="co"># Ammerman, 2013</span>
<span class="co"># Andersson, 2005</span>
<span class="co"># [...]</span></code></pre>
<p>ID conflicts typically occur because the information in the variables
used to build the IDs (see box above) is not sufficient to create a
unique ID for each comparison. Studies with non-unique IDs are
subsequently printed out. The <a href="https://tools.metapsy.org/reference/checkconflicts" class="external-link">checkConflicts</a>
function also has an argument called <code>vars.for.id</code>, which can
be used define (other or additional) columns to be used for ID
generation. This can sometimes help to create unique IDs.</p>
<p>As an illustration, we now define an extended variable list to be
used for our IDs in <a href="https://tools.metapsy.org/reference/checkconflicts" class="external-link">checkConflicts</a>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Define extended ID list </span>
<span class="co"># "target_group" is now also included</span>
<span class="va">id.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"study"</span>, <span class="st">"outcome_type"</span>,
             <span class="st">"instrument"</span>, <span class="st">"time"</span>, <span class="st">"time_weeks"</span>,
             <span class="st">"rating"</span>, <span class="st">"target_group"</span><span class="op">)</span>

<span class="co"># Use id.list as input for vars.for.id argument</span>
<span class="fu"><a href="../reference/checkConflicts.html">checkConflicts</a></span><span class="op">(</span><span class="va">depressionPsyCtr</span>,
               vars.for.id <span class="op">=</span> <span class="va">id.list</span><span class="op">)</span></code></pre></div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="effect-size-calculation">Effect Size Calculation<a class="anchor" aria-label="anchor" href="#effect-size-calculation"></a>
</h3>
<p>If the data set has been pre-formatted correctly, and all ID
conflicts were resolved, the <a href="https://tools.metapsy.org/reference/calculateeffectsizes" class="external-link"><code>calculateEffectSizes</code></a>
function can be used to <strong>calculate effect sizes</strong> (Hedges’
<span class="math inline">\(g\)</span> or risk ratios, <span class="math inline">\(RR\)</span>) for all comparisons in the
database.</p>
<p>The <a href="https://tools.metapsy.org/reference/calculateeffectsizes" class="external-link"><code>calculateEffectSizes</code></a>
function uses the information stored in the <a href="https://tools.metapsy.org/articles/metapsytools#effect-size-data-variables-ii" class="external-link">effect
size data variables</a> to calculate <span class="math inline">\(g\)</span> and/or <span class="math inline">\(RR\)</span>, depending on what information is
available. Therefore, it is very important to make sure these variables
are defined correctly before running <a href="https://tools.metapsy.org/reference/calculateeffectsizes" class="external-link"><code>calculateEffectSizes</code></a>.</p>
<p>The <a href="https://tools.metapsy.org/reference/calculateeffectsizes" class="external-link"><code>calculateEffectSizes</code></a>
function adds nine columns to the data set, all of which start with a
dot (<code>.</code>). They are included so that meta-analysis functions
in <code>metapsyTools</code> can be applied “out of the box”.</p>
<ul>
<li>
<strong><code>.id</code></strong>: Unique identifier for a trial arm
comparison/row.</li>
<li>
<strong><code>.g</code></strong>: Calculated effect size (Hedges’
<span class="math inline">\(g\)</span>).</li>
<li>
<strong><code>.g_se</code></strong>: Standard error of Hedges’ <span class="math inline">\(g\)</span>.</li>
<li>
<strong><code>.log_rr</code></strong>: Calculated effect size (<span class="math inline">\(\log_{e}\text{RR}\)</span>).</li>
<li>
<strong><code>.log_rr_se</code></strong>: Standard error of <span class="math inline">\(\log_{e}\text{RR}\)</span>.</li>
<li>
<strong><code>.event_arm1</code></strong>: Number of events
(e.g. responders) in the first trial arm.</li>
<li>
<strong><code>.event_arm2</code></strong>: Number of events
(e.g. responders) in the second trial arm.</li>
<li>
<strong><code>.totaln_arm1</code></strong>: Total sample size in the
first trial arm.</li>
<li>
<strong><code>.totaln_arm2</code></strong>: Total sample size in the
second trial arm.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculateEffectSizes.html">calculateEffectSizes</a></span><span class="op">(</span><span class="va">depressionPsyCtr</span><span class="op">)</span></code></pre></div>
<p>Now, let us have a look at the calculated effect sizes (<span class="math inline">\(g\)</span> and <span class="math inline">\(\log_eRR\)</span>) in a random slice of the
data:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Show rows 10 to 15, and variables "study", ".g", and ".log_rr"</span>
<span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"study"</span>, <span class="st">".g"</span>, <span class="st">".log_rr"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">#                   study         .g    .log_rr</span>
<span class="co"># 10     Ahmadpanah, 2016  1.7788677         NA</span>
<span class="co"># 11    Alexopoulos, 2016  0.2151835 -0.2436221</span>
<span class="co"># 12    Alexopoulos, 2016 -0.2151835  0.2436221</span>
<span class="co"># 13 Allart van Dam, 2003 -0.5696379         NA</span>
<span class="co"># 14 Allart van Dam, 2003  0.5696379         NA</span>
<span class="co"># 15       Ammerman, 2013 -0.9439887         NA</span></code></pre>
<p>We see one important detail here. When dichotomous outcome data is
provided, the <a href="https://tools.metapsy.org/reference/calculateeffectsizes" class="external-link"><code>calculateEffectSizes</code></a>
function automatically calculates both the log-risk ratio, and an
estimate of <span class="math inline">\(g\)</span>. Therefore, effects
on remission, response, etc. are by default also included in
meta-analyses based on Hedges’ <span class="math inline">\(g\)</span>.
Please make sure to filter these effect sizes out if you do not want to
have them included in your meta-analysis. The <a href="https://tools.metapsy.org/reference/filterpoolingdata" class="external-link"><code>filterPoolingData</code></a>
function, which we will cover later, allows to do this.</p>
<p><br></p>
<div class="section level4">
<h4 id="change-effect-size-sign">Change Effect Size Sign<a class="anchor" aria-label="anchor" href="#change-effect-size-sign"></a>
</h4>
<p>The <code>change.sign</code> argument in
<code>calculateEffectSizes</code> can be used to change the sign of one
or several calculated effect sizes (e.g. change the calculated effect
size from <span class="math inline">\(g\)</span>=0.30 to <span class="math inline">\(g\)</span>=—0.30, or vice versa). This is
illustrated below:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Take a slice of the data for illustration</span>
<span class="va">depressionPsyCtrSubset</span> <span class="op">&lt;-</span> <span class="va">depressionPsyCtr</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span>

<span class="co"># Create a logical variable which, for each row,</span>
<span class="co"># indicates if the sign of g should be changed</span>
<span class="va">depressionPsyCtrSubset</span><span class="op">$</span><span class="va">sign_change</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, 
                                        <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Calculate effect sizes while defining the variable in </span>
<span class="co"># our data in which the change sign information is stored</span>
<span class="va">data.change.sign</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculateEffectSizes.html">calculateEffectSizes</a></span><span class="op">(</span>
                      <span class="va">depressionPsyCtrSubset</span>,
                      change.sign <span class="op">=</span> <span class="st">"sign_change"</span><span class="op">)</span>

<span class="co"># Show the relevant columns</span>
<span class="va">data.change.sign</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">.g</span>, <span class="va">.log_rr</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">#                  study         .g    .log_rr</span>
<span class="co"># 1     Ahmadpanah, 2016 -1.7788677         NA</span>
<span class="co"># 2    Alexopoulos, 2016  0.2151835 -0.2436221</span>
<span class="co"># 3    Alexopoulos, 2016  0.2151835  0.2436221</span>
<span class="co"># 4 Allart van Dam, 2003  0.5696379         NA</span>
<span class="co"># 5 Allart van Dam, 2003 -0.5696379         NA</span>
<span class="co"># 6       Ammerman, 2013 -0.9439887         NA</span></code></pre>
<p>We see that <code>.g</code> has now changed where ever
<code>sign_change</code> has been set to <code>TRUE</code>. We also see
that this <strong>does not affect</strong> the estimates of <span class="math inline">\(\log_eRR\)</span>.</p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="including-switched-arms">Including Switched Arms<a class="anchor" aria-label="anchor" href="#including-switched-arms"></a>
</h4>
<p>By default, Metapsy databases will only include all unique trial arm
<strong>combinations</strong>, not all unique
<strong>comparisons</strong>. To show when and why this difference
matters, let us consider a small example.</p>
<p>Imagine that we have data of a four-arm trial. Say that this trial
included CBT, PST, CAU and a wait-list condition. While this trial
provides 6 unique trial arm combinations<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, the number of unique
<em>comparisons</em> is higher: <span class="math inline">\(\frac{n!}{(n-k)!} = \frac{4!}{2!} =
12\)</span>.</p>
<p>This is because the sign of the calculated effect size depends on
which treatment serves as the <em>reference</em>. The effect of CBT
vs. PST, for example, depends on which arm serves as the reference group
(i.e. CBT vs. PST or PST vs. CBT). Depending on which arm is chosen (and
assuming non-zero mean differences), the calculated effect size
(e.g. Hedges’ <span class="math inline">\(g\)</span>) value will either
be negative (e.g. <span class="math inline">\(g\)</span>=-0.31) or
positive (<span class="math inline">\(g\)</span>=0.31). We see this
visualized in the graph below. There are now two directed arrows for
each comparison (12 in total), and each arrow reads as “is compared
to”:</p>
<center>
<img src="graph2.png" width="200">
</center>
<p>To truly calculate all unique <em>comparisons</em>, we have to set
the <code>include.switched.arms</code> argument to <code>TRUE</code>
when running <code>calculateEffectSizes</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data.switched.arms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculateEffectSizes.html">calculateEffectSizes</a></span><span class="op">(</span>
                        <span class="va">depressionPsyCtr</span>,
                        include.switched.arms <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>The resulting data frame <code>data</code> now includes all effect
sizes that can theoretically be calculated (assuming that all relevant
combinations were included in the original data).</p>
<p><br></p>
<div style="background-color: #f1f3f5 !important; padding: 25px; border-radius: 5px; color: gray; box-shadow: 0px 0px 5px;">
<p><strong>Should I use include.switched.arms?</strong> It is not
essential to calculate all possible arm comparisons. However, having all
possible comparisons in your data set is convenient, because all
required comparisons pertaining to a particular research question
(e.g. “how effective is PST when CBT is the reference group?”) can
directly be filtered out; there is typically no need for further data
manipulation steps then.</p>
<p>The <code>include.switched.arms</code> argument can also be helpful
if you want to prepare <strong>network meta-analysis</strong> data
(which is subsequently analyzed using, e.g., the <a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/netwma.html#frequentist-network-meta-analysis-in-r" class="external-link"><code>netmeta</code></a>
package). However, this assumes that the data set already contains all
unique <strong>combinations</strong> in multi-arm trials (e.g. all 6
combinations in the four-arm study above, not just a selection).</p>
</div>
<p><br></p>
<p>This leads to our final data set which can be used with the
<strong>analysis module</strong>, which will be described next.</p>
<p><br></p>
<p><br></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="the-analysis-module">
<img src="https://tools.metapsy.org/figures/analysis.svg" width="30px" style="padding-right: 5px;">
The Analysis Module<a class="anchor" aria-label="anchor" href="#the-analysis-module"></a>
</h2>
<hr>
<p>The analysis module in <code>metapsyTools</code> allows to run
different kinds of meta-analyses based on the final data set created by
the preparation module. It is designed to also be usable by researchers
who were not directly involved in the preparation step, and is less
demanding in terms of required background knowledge. Metapsy databases
included in <a href="https://data.metapsy.org/" class="external-link"><strong>metapsyData</strong></a> can
directly be used by the analysis module in
<code>metapsyTools</code>.</p>
<p>The analysis module allows, among other things, to:</p>
<ul>
<li>Filter data using strict rules, fuzzy string matching, or by
implementing prioritization rules (<a href="https://tools.metapsy.org/reference/filterpoolingdata" class="external-link"><code>filterPoolingData</code></a>
and <a href="https://tools.metapsy.org/reference/filterpriorityrule" class="external-link"><code>filterPriorityRule</code></a>)<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</li>
<li>Run conventional random-effects meta-analysis models, as well as
commonly reported sensitivity analyses (<a href="https://tools.metapsy.org/reference/runmetaanalysis" class="external-link"><code>runMetaAnalysis</code></a>).</li>
<li>Correct effect estimates for potential publication bias or
small-study effects (<a href="https://tools.metapsy.org/reference/correctpublicationbias" class="external-link"><code>correctPublicationBias</code></a>).</li>
<li>Run subgroup analyses based on the fitted model (<a href="https://tools.metapsy.org/reference/subgroupanalysis" class="external-link"><code>subgroupAnalysis</code></a>)</li>
<li>Create study information tables (<a href="https://tools.metapsy.org/reference/createstudytable" class="external-link"><code>createStudyTable</code></a>).</li>
</ul>
<p><br></p>
<div class="section level3">
<h3 id="filtering-relevant-comparisons">Filtering Relevant Comparisons<a class="anchor" aria-label="anchor" href="#filtering-relevant-comparisons"></a>
</h3>
<p>The <code>metapsyTools</code> package contains functions which allow
to flexibly filter out comparisons that are relevant for a particular
meta-analysis.</p>
<p>The <a href="https://tools.metapsy.org/reference/filterpoolingdata" class="external-link"><code>filterPoolingData</code></a>
function is the main function for filtering. We simply have to provide
the final data set with calculated effect sizes (see <a href="https://tools.metapsy.org/articles/metapsytools#the-preparation-module" class="external-link">preparation
module</a>), as well as one or several filtering criteria pertaining to
our specific research question.</p>
<p>Say that we want to run a meta-analysis of all studies in which CBT
was compared to wait-lists, with the BDI-II at post-test being the
analyzed outcome. We can filter out the relevant comparisons like
this:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load the pre-installed "depressionPsyCtr" dataset</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"depressionPsyCtr"</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">depressionPsyCtr</span>

<span class="co"># Filter relevant comparisons</span>
<span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="../reference/filterPoolingData.html">filterPoolingData</a></span><span class="op">(</span>
      <span class="va">condition_arm1</span> <span class="op">==</span> <span class="st">"cbt"</span>,
      <span class="va">condition_arm2</span> <span class="op">==</span> <span class="st">"wl"</span>,
      <span class="va">instrument</span> <span class="op">==</span> <span class="st">"bdi-1"</span>,
      <span class="va">time</span> <span class="op">==</span> <span class="st">"post"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co"># [1] 7</span></code></pre>
<p>We see that <span class="math inline">\(k\)</span>=7 comparisons
fulfill these criteria. Note, however, that this will only select
comparisons for which <code>condition_arm1</code> was <em>exactly</em>
defined as <code>"cbt"</code>.</p>
<p>It is also possible to filter out all rows that simply
<em>contain</em> a specific search term (<strong>fuzzy
matching</strong>). For example, instead of <code>"cbt"</code>, we might
want to filter out all studies that employed some type of “other”
therapy format. This can be achieved by using the <code>Detect</code>
function within <a href="https://tools.metapsy.org/reference/filterpoolingdata" class="external-link"><code>filterPoolingData</code></a>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/filterPoolingData.html">filterPoolingData</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/Detect.html">Detect</a></span><span class="op">(</span><span class="va">condition_arm1</span>, <span class="st">"other"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">condition_arm1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co"># [1] "other psy" "other ctr" "other ctr" "other ctr" "other ctr" "other ctr" </span>
<span class="co"># [7] "other ctr" "other ctr" "other psy"</span></code></pre>
<p>We can create even more complex filters. Say that we want to examine
the effect, as measured by the BDI-I at post-test, of CBT, PST, and BAT
compared to <em>either</em> CAU or wait-lists. We can visualize this
with a graph again:</p>
<center>
<img src="graph3.png" width="200">
</center>
<p>We can use the OR-Operator <code>|</code> within
<code>filterPoolingData</code> for such filter types. Again, we use the
<code>Detect</code> function to allow for fuzzy matching:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/filterPoolingData.html">filterPoolingData</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/Detect.html">Detect</a></span><span class="op">(</span><span class="va">condition_arm1</span>, <span class="st">"cbt|pst|bat"</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/Detect.html">Detect</a></span><span class="op">(</span><span class="va">condition_arm2</span>, <span class="st">"cau|wl"</span><span class="op">)</span>,
    <span class="va">instrument</span> <span class="op">==</span> <span class="st">"bdi-1"</span>,
    <span class="va">time</span> <span class="op">==</span> <span class="st">"post"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co"># [1] 11</span></code></pre>
<p><br></p>
<p>Lastly, one can also filter data according to a specified
<strong>priority rule</strong>, using the <a href="https://tools.metapsy.org/reference/filterpriorityrule" class="external-link"><code>filterPriorityRule</code></a>
function. This is particularly helpful to select instruments. Say, for
example, that we ordered certain instruments based on their known
reliability. Now, for each study, we only want to select the comparison
in which the most reliable instrument was used. It is possible that, for
some studies, all used instruments are relatively unreliable. However,
given our priority rule, we can still extract the comparison with a
<em>relatively</em> high reliability, and discard all the other
measurements within one study that are even less reliable.</p>
<p>Assume that our priority rule for the employed instrument is
<code>"hdrs"</code> (priority 1), <code>"bdi-2"</code> (priority 2),
<code>"phq-9"</code> (priority 3) and <code>"bdi-1"</code> (priority 4).
We can implement the rule like this:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  
  <span class="co"># First, filter all other relevant characteristics</span>
  <span class="fu"><a href="../reference/filterPoolingData.html">filterPoolingData</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/Detect.html">Detect</a></span><span class="op">(</span><span class="va">condition_arm1</span>, <span class="st">"cbt|pst|bat"</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/Detect.html">Detect</a></span><span class="op">(</span><span class="va">condition_arm2</span>, <span class="st">"cau|wl"</span><span class="op">)</span>,
    <span class="va">time</span> <span class="op">==</span> <span class="st">"post"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  
  <span class="co"># Now, implement the priority rule for the outcome instrument</span>
  <span class="fu"><a href="../reference/filterPriorityRule.html">filterPriorityRule</a></span><span class="op">(</span>
    instrument <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hdrs"</span>, <span class="st">"bdi-2"</span>, 
                   <span class="st">"phq-9"</span>, <span class="st">"bdi-1"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  
  <span class="co"># Show number of entries</span>
  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co"># [1] 20</span></code></pre>
<p><br></p>
</div>
<div class="section level3">
<h3 id="pooling-effects">Pooling Effects<a class="anchor" aria-label="anchor" href="#pooling-effects"></a>
</h3>
<p>After all relevant rows have been filtered out, we can start to pool
the effect sizes. The <a href="https://tools.metapsy.org/reference/runmetaanalysis" class="external-link"><code>runMetaAnalysis</code></a>
function serves as a wrapper for several commonly used meta-analytic
approaches, and, by default, applies them all at once to our data:</p>
<ul>
<li>
<code>"overall"</code>. Runs a generic inverse-variance
(random-effects) model. All included effect sizes are treated as
independent. If raw event data is available in the
<code>event_arm1</code>, <code>event_arm2</code>,
<code>totaln_arm1</code>, <code>totaln_arm2</code> columns (see <a href="#effect-size-calculation">Effect Size Calculation</a>), the
Mantel-Haenszel method (Greenland &amp; Robins, <a href="https://www.jstor.org/stable/2530643" class="external-link">1985</a>) is used to pool
effects.</li>
<li>
<code>"combined"</code>. Pools all effect sizes within one study
before calculating the overall effect. This ensures that all effect
sizes are independent (i.e., unit-of-analysis error &amp;
double-counting is avoided). To combine the effects, one has to assume a
<strong>correlation</strong> of effect sizes within studies, empirical
estimates of which are typically not available. By default,
<code>runMetaAnalysis</code> assumes that <span class="math inline">\(\rho\)</span>=0.6.</li>
<li>
<code>"lowest.highest"</code>. Runs a meta-analysis, but with only
(i) the lowest and (ii) highest effect size within each study
included.</li>
<li>
<code>"outlier"</code>. Runs a meta-analysis without statistical
outliers (i.e. effect sizes for which the confidence interval does not
overlap with the confidence interval of the overall effect).</li>
<li>
<code>"influence"</code>. Runs a meta-analysis without influential
cases, as defined using the “rules of thumb” in Viechtbauer &amp; Cheung
(<a href="https://onlinelibrary.wiley.com/doi/10.1002/jrsm.11" class="external-link">2010</a>).
See also the <a href="https://dmetar.protectlab.org/reference/influenceanalysis" class="external-link"><code>InfluenceAnalysis</code></a>
function in <a href="https://dmetar.protectlab.org/" class="external-link"><code>dmetar</code></a>.</li>
<li>
<code>"rob"</code>. Runs a meta-analysis with only low-RoB studies
included. By default, only studies with a value <code>&gt; 2</code> in
the <code>rob</code> variable are considered for this analysis.</li>
<li>
<code>"threelevel"</code>. Runs a multilevel (three-level)
meta-analysis model, with effect sizes nested in studies (Harrer et al.,
2022, <a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/multilevel-ma.html" class="external-link">chap. 10</a>).</li>
<li>
<code>"threelevel.che"</code>. Runs a multilevel (three-level)
“correlated and hierarchical effects” (CHE) meta-analysis model. In this
model, effect sizes are nested in studies, and effects within studies
are assumed to be correlated (by default, it is assumed that <span class="math inline">\(\rho\)</span>=0.6; <a href="https://link.springer.com/article/10.1007/s11121-021-01246-3" class="external-link">Pustejovsky
&amp; Tipton, 2022</a>). This will typically be a plausible modeling
assumption in most real-world use cases.</li>
</ul>
<p>To illustrate how the function works, we first select a subset of our
“toy” <code>depressionPsyCtr</code> data.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Only select data comparing CBT to waitlists and CAU</span>
<span class="va">depressionPsyCtr</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/filterPoolingData.html">filterPoolingData</a></span><span class="op">(</span>
    <span class="va">condition_arm1</span> <span class="op">==</span> <span class="st">"cbt"</span>,
    <span class="fu"><a href="../reference/Detect.html">Detect</a></span><span class="op">(</span><span class="va">condition_arm2</span>, <span class="st">"wl|cau"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">-&gt;</span> <span class="va">ma.data</span></code></pre></div>
<p>Then, we plug the data set into the <code>runMetaAnalysis</code>
function:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runMetaAnalysis.html">runMetaAnalysis</a></span><span class="op">(</span><span class="va">ma.data</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co"># - Running meta-analyses...</span>
<span class="co"># - [OK] Using Hedges' g as effect size metric... </span>
<span class="co"># - [OK] Calculating overall effect size... DONE</span>
<span class="co"># - [OK] Calculating effect size using only lowest effect... DONE</span>
<span class="co"># - [OK] Calculating effect size using only highest effect... DONE</span>
<span class="co"># - [OK] Calculating effect size using combined effects (rho=0.6; arm-wise)... DONE</span>
<span class="co"># - [OK] Calculating effect size with outliers removed... DONE</span>
<span class="co"># - [OK] Calculating effect size with influential cases removed... DONE</span>
<span class="co"># - [OK] Calculating effect size using only low RoB information... DONE</span>
<span class="co"># - [OK] Calculating effect size using three-level MA model... DONE</span>
<span class="co"># - [OK] Robust variance estimation (RVE) used for three-level MA model... DONE</span>
<span class="co"># - [OK] Calculating effect size using three-level CHE model (rho=0.6)... DONE</span>
<span class="co"># - [OK] Robust variance estimation (RVE) used for three-level CHE model... DONE</span>
<span class="co"># - [OK] Done!</span></code></pre>
<p>As we can see, while running, the <code>runMetaAnalysis</code>
function provides us with a few messages that allow to trace if all
models have been fitted successfully. When there are problems during the
calculation, the <code>runMetaAnalysis</code> function will print a
warning.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># This tells the function to only consider studies with a rob score </span>
<span class="co"># above 4 in the "low risk of bias" sensitivity analysis</span>
<span class="fu"><a href="../reference/runMetaAnalysis.html">runMetaAnalysis</a></span><span class="op">(</span><span class="va">ma.data</span>, low.rob.filter <span class="op">=</span> <span class="st">"rob &gt; 4"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co"># [...]</span>
<span class="co"># - [!] No low risk of bias studies detected! Switching to 'general'... DONE</span>
<span class="co"># [...]</span></code></pre>
<p>We can inspect the results by calling the created <code>res</code>
object in the console.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span></code></pre></div>
<pre><code><span class="co"># Model results ------------------------------------------------ </span>
<span class="co"># Model                       k     g g.ci           p         i2 i2.ci          prediction.ci   nnt</span>
<span class="co"># Overall                    26 -0.57 [-0.85; -0.28] &lt;0.001  76.4 [65.65; 83.76] [-1.57; 0.43]  5.22</span>
<span class="co"># Combined                   17 -0.54 [-0.89; -0.18] 0.005   77.1 [63.64; 85.57] [-1.64; 0.57]  5.56</span>
<span class="co"># One ES/study (lowest)      14 -0.57 [-1; -0.13]    0.015   79.8 [66.82; 87.65] [-1.78; 0.64]  5.22</span>
<span class="co"># One ES/study (highest)     14 -0.47 [-0.84; -0.11] 0.015   73.9 [55.75; 84.62] [-1.45; 0.5]   6.41</span>
<span class="co"># Outliers removed           23 -0.46 [-0.63; -0.29] &lt;0.001  61.6 [39.55; 75.55] [-1.11; 0.19]  6.64</span>
<span class="co"># Influence Analysis         24 -0.43 [-0.6; -0.27]  &lt;0.001  63.9 [44.18; 76.66] [-1.08; 0.22]  7.08</span>
<span class="co"># Only rob &gt; 2               13 -0.34 [-0.58; -0.11] 0.008   73.4 [53.91; 84.71] [-1.1; 0.41]   9.12</span>
<span class="co"># Three-Level Model          26 -0.61 [-1.05; -0.17] 0.011   92.1 -              [-2.17; 0.96]  4.81</span>
<span class="co"># Three-Level Model (CHE)    26 -0.55 [-0.92; -0.18] 0.007   88   -              [-1.8; 0.7]    5.42</span>
<span class="co"># </span>
<span class="co"># Variance components (three-level model) ---------------------- </span>
<span class="co"># Source           tau2    i2</span>
<span class="co"># Between Studies 0.536  92.1</span>
<span class="co"># Within Studies  0       0  </span>
<span class="co"># Total           0.536  92.1</span>
<span class="co"># </span>
<span class="co"># Variance components (three-level CHE model) ------------------ </span>
<span class="co"># Source           tau2    i2</span>
<span class="co"># Between Studies 0.336  87.2</span>
<span class="co"># Within Studies  0.003   0.8</span>
<span class="co"># Total           0.339  88  </span></code></pre>
<p>By default, an <strong>HTML table</strong> should pop up along with
the console output. These pre-formatted HTML results tables can easily
be transferred to, for example, MS Word using copy and paste. To disable
this feature, we have to specify <code>html=FALSE</code> inside the
function call.</p>
<iframe src="https://tools.metapsy.org/figures/tbl.html" style="width: 100%; height: 745px;">
</iframe>
<p><br></p>
<p>Using the <code>summary</code> method, details of the analysis
settings can be printed. This function also returns recommended
citations for the applied methods and/or packages. Furthermore, it
creates a <strong>summary forest plot</strong> in which all pooled
effects are displayed.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/print.rma.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Analysis settings ---------------------------------------------------------- </span>
<span class="co">## </span>
<span class="co">## ✓ [Overall] Random effects model assumed. </span>
<span class="co">## ✓ [Overall] Heterogeneity variance (tau2) calculated using restricted maximum-likelihood estimator. </span>
<span class="co">## ✓ [Overall] Test statistic and CI of the pooled effect calculated using the Knapp-Hartung adjustment. </span>
<span class="co">## ✓ [Outliers removed] ES removed as outliers if the CI did not overlap with pooled effect CI. </span>
<span class="co">## ✓ [Influence Analysis] Influential cases determined using diagnostics of Viechtbauer and Cheung (2010). </span>
<span class="co">## [...]</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## Cite the following packages/methods: ---------------------------------------</span>
<span class="co">## </span>
<span class="co">##  - {meta}: Balduzzi S, Rücker G, Schwarzer G (2019),</span>
<span class="co">##           How to perform a meta-analysis with R: a practical tutorial,</span>
<span class="co">##           Evidence-Based Mental Health; 22: 153-160. </span>
<span class="co">##  - {metafor}: Viechtbauer, W. (2010). Conducting meta-analyses in R</span>
<span class="co">##           with the metafor package. Journal of Statistical Software, 36(3), 1-48.</span>
<span class="co">##           https://doi.org/10.18637/jss.v036.i03. </span>
<span class="co">##  [...]</span></code></pre>
<p><img src="https://tools.metapsy.org/figures/forest_summary.png"></p>
<p><br></p>
<div class="section level4">
<h4 id="additional-arguments">Additional Arguments<a class="anchor" aria-label="anchor" href="#additional-arguments"></a>
</h4>
<p>The <code>runMetaAnalysis</code> function allows to tweak many, many
details of the specific meta-analysis models (run
<code><a href="../reference/runMetaAnalysis.html">?runMetaAnalysis</a></code> to see the entire documentation). The most
important arguments one may want to specify are:</p>
<ul>
<li>
<code>es.measure</code>. By default, the function conducts analyses
using the Hedges <span class="math inline">\(g\)</span> values stored in
the data set. To conduct analyses using dichotomous outcome data
(i.e. response, remission, etc.), one has to set this argument to
<code>"RR"</code>.</li>
<li>
<code>es.type</code>. By default, analyses are conducted using the
<code>"precalculated"</code> effect sizes stored in the prepared data
set. For risk ratios, one can alternatively set this argument to
<code>"raw"</code>, which means that the “raw” event counts are used for
computations (instead of the pre-calculated log-risk ratio and its
standard error). This is typically preferable, but may not be possible
if this information could not be extracted from all primary
studies.</li>
<li>
<code>method.tau</code>. This argument controls the method to be
used for estimating the between-study heterogeneity variance <span class="math inline">\(\tau^2\)</span>. The default is
<code>"REML"</code> (restricted maximum likelihood), but other options
such as the DerSimonian-Laird estimator (<code>"DL"</code>) are also
available (see the <a href="https://tools.metapsy.org/reference/runmetaanalysis" class="external-link"><code>runMetaAnalysis</code></a>
function documentation for more details). Note that three-level
meta-analysis models can only be fitted using (restricted) maximum
likelihood.</li>
<li>
<code>nnt.cer</code>. The <code>runMetaAnalysis</code> function uses
the method by Furukawa and Leucht (<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0019070" class="external-link">2011</a>)
to calculate the Number Needed to Treat (NNT) for each pooled effect
size. This method needs an estimate of the control group event rate
(CER). By default, <code>nnt.cer = 0.2</code> is used, but you can set
this to another value if desired.</li>
<li>
<code>rho.within.study</code>. To combine effect sizes on a study
level before pooling (<code>"combined"</code> model), one has to assume
a within-study correlation of effects. By default,
<code>rho.within.study = 0.6</code> is assumed, but this value can and
should be changed based on better approximations. This value also
controls the assumed within-study correlation in the multilevel CHE
model (<code>"theelevel.che"</code>).</li>
<li>
<code>low.rob.filter</code>. By default, the function uses all
comparisons for which the risk of bias rating in the <code>rob</code>
variable has a value greater <code>2</code>
(<code>low.rob.filter = "rob &gt; 2"</code>). If your risk of bias
rating is in another variable, or if another threshold should be used,
you can change this argument accordingly.</li>
</ul>
<p>Here is an example of a <code>runMetaAnalysis</code> call with
non-default settings:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/runMetaAnalysis.html">runMetaAnalysis</a></span><span class="op">(</span><span class="va">data</span>,
                es.measure <span class="op">=</span> <span class="st">"RR"</span>,
                es.type <span class="op">=</span> <span class="st">"raw"</span>,
                method.tau <span class="op">=</span> <span class="st">"DL"</span>,
                nnt.cer <span class="op">=</span> <span class="fl">0.4</span>,
                rho.within.study <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></code></pre></div>
<p><br></p>
</div>
<div class="section level4">
<h4 id="confidence-intervals-for-three-level-model-tau2-and-i2-values">Confidence Intervals for Three-Level Model <span class="math inline">\(\tau^2\)</span> and <span class="math inline">\(I^2\)</span> Values<a class="anchor" aria-label="anchor" href="#confidence-intervals-for-three-level-model-tau2-and-i2-values"></a>
</h4>
<p>Please note that, by default, no confidence intervals are printed for
the <span class="math inline">\(I^2\)</span> value of the
<code>"threelevel"</code> and <code>"threelevel.che"</code> model (the
same is also the case for the <span class="math inline">\(G^2\)</span>
value, the equivalent of <span class="math inline">\(I^2\)</span> in
limit meta-analyses; see <a href="#publication-bias">Publication
Bias</a> section)<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>. This is because there are two
heterogeneity variances in three-level models (the “conventional”
between-study heterogeneity variance <span class="math inline">\(\tau^2_{(1)}\)</span> and the heterogeneity
variance within studies, <span class="math inline">\(\tau^2_{(2)}\)</span>). This means that there are
also two <span class="math inline">\(I^2\)</span> values, one within
studies, and one for the between-study heterogeneity. Established
closed-form or iterative solutions (such as the <span class="math inline">\(Q\)</span>-Profile method; Viechtbauer, <a href="https://pubmed.ncbi.nlm.nih.gov/16463355/" class="external-link">2007</a>) are not
directly applicable here, which means that confidence intervals cannot
be calculated that easily.</p>
<p>In <code>metapsyTools</code>, one can resort to the
<strong>parametric bootstrap</strong> (van den Noortgate &amp; Onghena,
<a href="https://link.springer.com/content/pdf/10.3758/BF03206394.pdf" class="external-link">2005</a>)
to obtain approximate confidence intervals around the <span class="math inline">\(\tau^2\)</span> and <span class="math inline">\(I^2\)</span> values. Bootstrapping is performed
when the <code>i2.ci.boot</code> argument is set to <code>TRUE</code>.
By default, <span class="math inline">\(n\)</span>=5000 bootstrap
samples are drawn, which should be seen as the absolute lower limit;
more replications are preferable and can be specified via the
<code>nsim.boot</code> argument.</p>
<p>Please note that the <strong>bootstrapping is computationally
expensive</strong>, which means that it can take up to an hour and
longer until final results are obtained. During the bootstrapping
procedure, the function prints a progress update so that users get an
indication of how long the function (still) has to run.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res.boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runMetaAnalysis.html">runMetaAnalysis</a></span><span class="op">(</span><span class="va">ma.data</span>,
                            i2.ci.boot <span class="op">=</span> <span class="cn">TRUE</span>,
                            nsim.boot <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>
<span class="va">res.boot</span></code></pre></div>
<pre><code><span class="co"># 1% completed | 2% completed | 3% completed ...</span></code></pre>
<p>Confidence intervals around <span class="math inline">\(I^2\)</span>
and the <span class="math inline">\(\tau^2\)</span> will then be printed
out along with the usual results.</p>
<pre><code><span class="co"># [...]</span>
<span class="co"># Variance components (three-level model) ---------------------- </span>
<span class="co"># Source           tau2 tau2.ci           i2 i2.ci         </span>
<span class="co"># Between Studies 0.536 [0.178; 1.092]  92.1 [74.29; 95.72]</span>
<span class="co"># Within Studies  0     [0; 0.055]       0   [0; 10.43]    </span>
<span class="co"># Total           0.536 [0.182; 1.107]  92.1 [79.83; 96.01]</span>
<span class="co"># </span>
<span class="co"># Variance components (three-level CHE model) ------------------ </span>
<span class="co"># Source           tau2 tau2.ci           i2 i2.ci         </span>
<span class="co"># Between Studies 0.336 [0.068; 0.667]  87.2 [56.65; 92.9] </span>
<span class="co"># Within Studies  0.003 [0; 0.03]        0.8 [0; 10.31]    </span>
<span class="co"># Total           0.339 [0.079; 0.681]  88   [63.17; 93.67]</span></code></pre>
<p>When <code>runMetaAnalysis</code> was run with
<code>i2.ci.boot</code> set to <code>TRUE</code>, the <span class="math inline">\(I^2\)</span> (or, more correctly, <span class="math inline">\(G^2\)</span>) value of the <strong>limit
meta-analysis</strong> will also be calculated using parametric
bootstraping, provided that <code>correctPublicationBias</code> is
called afterwards (see <a href="https://tools.metapsy.org/articles/metapsytools#publication-bias" class="external-link">publication
bias</a> section).</p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="complex-variance-covariance-approximation">
<strong>Complex Variance-Covariance Approximation</strong><a class="anchor" aria-label="anchor" href="#complex-variance-covariance-approximation"></a>
</h4>
<p>The <code>vcov</code> argument in
<code>runMetaAnalysis</code>controls if the effect size dependencies
within the data should be approximated using a <code>"simple"</code>
(default) or more <code>"complex"</code> (but potentially more accurate)
method. This argument is only relevant for the <code>"combined"</code>
and <code>"threelevel.che"</code> models. The default “simple” method
constructs variance-covariance matrices <span class="math inline">\(\Sigma_k\)</span> for each study using a constant
sampling correlation <span class="math inline">\(\rho\)</span> (defined
by <code>rho.within.study</code>), which is identical across all
studies, outcomes, and time points. This simplifying assumption is part
of the formulation of the CHE model originally provided by Pustejovsky
and Tipton (<a href="https://link.springer.com/article/10.1007/s11121-021-01246-3" class="external-link">2022</a>).</p>
<p>Naturally, employing a common value of <span class="math inline">\(\rho\)</span> across all studies may not be
reasonable in some analyses, and other information may be available to
better approximate the effect size dependencies in the collected data.
Setting <code>vcov</code> to <code>"complex"</code> allows to assume
that correlations between effect sizes may differ conditional on the
type of dependency. This means that the variance-covariance matrix <span class="math inline">\(\Sigma_k\)</span> of some study <span class="math inline">\(k\)</span> is approximated by an unstructured
matrix with varying <span class="math inline">\(\rho_{ij}\)</span>.</p>
<p>Put simply, this method allows to account for the fact that there can
be <strong>various types of effect size dependencies</strong>
(e.g. effect sizes are dependent because different instruments were used
on the same sample; or they are dependent because effects of two
different intervention groups were compared to the same control group in
a multi-arm trial, and so on) and that, therefore, the <strong>magnitude
of the correlation</strong> also <strong>differs</strong>.</p>
<p>Setting <code>vcov = "complex"</code> allows to additionally
incorporate assumed correlations specific to multiple testing over time
(e.g. correlations between effects at post-test and long-term
follow-up). The value provided in <code>phi.within.study</code>
represents the <strong>(auto-)correlation</strong> coefficient <span class="math inline">\(\phi\)</span>, which serves as a rough estimate of
the re-test correlation after 1 week. This allows to model the gradual
decrease in correlation between measurements over time.</p>
<p>Furthermore, it is possible to calculate a correlation coefficient
<span class="math inline">\(\rho_w\)</span> for <strong>multi-arm
trials</strong>, which is directly proportional to the size of each
individual trial arm. When all trial arms have the same size, meaning
that each arm’s weight <span class="math inline">\(w\)</span> is
identical, <span class="math inline">\(\rho_w\)</span> is known to be
0.5. Multiarm weights <span class="math inline">\(w\)</span> (and thus
<span class="math inline">\(\rho_w\)</span>) can be derived if the
<code>w1.var</code> and <code>w2.var</code> variables, containing the
sample size of each study arm, are available.</p>
<p>Using the complex approximation method increases the risk that at
least one studies’ <span class="math inline">\(\Sigma_k\)</span> matrix
is not <strong>positive definite</strong>. In this case, the function
automatically switches back to the constant sampling correlation
approximation.</p>
<p>If the supplied data set format strictly follows the <a href="https://docs.metapsy.org/data-preparation/format/" class="external-link"><strong>Metapsy
data standard</strong></a>, it is possible to set <code>vcov</code> to
<code>"complex"</code> without any further preparation steps. The
function will then inform us if the complex variance-covariance
approximation was not possible, meaning that the function automatically
reverted to the standard <code>"simple"</code> approach.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/runMetaAnalysis.html">runMetaAnalysis</a></span><span class="op">(</span><span class="va">ma.data</span>,
                vcov <span class="op">=</span> <span class="st">"complex"</span><span class="op">)</span></code></pre></div>
<p>If you want to use the complex variance-covariance matrix
approximation feature, it is advised to make sure that the data set
contains the following columns:</p>
<ul>
<li><p><code>"n_arm1"</code> and <code>"n_arm2"</code>: sample sizes in
the two compared groups.</p></li>
<li><p><code>"time_weeks"</code>: post-randomization time point at which
the measurement was made (in weeks).</p></li>
</ul>
<p>For a correctly preformatted dataset, users are referred to the <a href="https://tools.metapsy.org/reference/depressionpsyctr" class="external-link"><code>depressionPsyCtr</code></a>
“toy” dataset.</p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="internal-objects">Internal Objects<a class="anchor" aria-label="anchor" href="#internal-objects"></a>
</h4>
<p>It is important to note that <code>runMetaAnalysis</code> is a
<strong>wrapper</strong> function. It provides a common interface to run
several meta-analysis models, while the models themselves are fitted
internally by other packages. In particular, we use functionality
provided by the <code>meta</code> (Balduzzi, Rücker &amp; Schwarzer, <a href="https://www.doi.org/10.1136/ebmental-2019-300117" class="external-link">2019</a>), <a href="https://wviechtb.github.io/metafor/index.html" class="external-link"><code>metafor</code></a>
(Viechtbauer, <a href="https://doi.org/10.18637/jss.v036.i03" class="external-link">2010</a>),
and <a href="http://dmetar.protectlab.org" class="external-link"><code>dmetar</code></a>
(Harrer, Cuijpers, Furukawa &amp; Ebert, 2019) packages.</p>
<p>When returning the results, <code>runMetaAnalysis</code> saves all
fitted models inside the returned object. Depending on their type, these
<strong>internal meta-analysis models</strong> work just like regular
<code>meta</code> or <code>metafor</code> models, which means that all
functionality developed for them is also available.</p>
<p>It is also possible to directly extract each calculated model from
the <code>runMetaAnalysis</code> results object. Each of these models
are identical to the ones one would receive by running <a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/pooling-es.html#pre-calculated-es" class="external-link"><code>metagen</code></a>,
<a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/pooling-es.html#ppoolbin" class="external-link"><code>metabin</code></a>,
or <a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/multilevel-ma.html#multilevel-R" class="external-link"><code>rma.mv</code></a>
directly.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span><span class="op">$</span><span class="va">model.overall</span>         <span class="co"># "overall" model (metagen/metabin)</span>
<span class="va">res</span><span class="op">$</span><span class="va">model.combined</span>        <span class="co"># "combined" model (metagen/metabin)</span>
<span class="va">res</span><span class="op">$</span><span class="va">model.lowest</span>          <span class="co"># lowest effect size/study only model (metagen/metabin)</span>
<span class="va">res</span><span class="op">$</span><span class="va">model.highest</span>         <span class="co"># highest effect size/study only model (metagen/metabin)</span>
<span class="va">res</span><span class="op">$</span><span class="va">model.outliers</span>        <span class="co"># outliers removed model (metagen/metabin)</span>
<span class="va">res</span><span class="op">$</span><span class="va">model.influence</span>       <span class="co"># influential cases removed model (metagen/metabin)</span>
<span class="va">res</span><span class="op">$</span><span class="va">model.rob</span>             <span class="co"># low RoB model (metagen/metabin)</span>
<span class="va">res</span><span class="op">$</span><span class="va">model.threelevel</span>      <span class="co"># three-level model</span>
<span class="va">res</span><span class="op">$</span><span class="va">model.threelevel.che</span>  <span class="co"># three-level CHE model</span></code></pre></div>
<p>This means that <strong>any kind of operation</strong> available for
<code>metagen</code> or <code>rma</code> models <strong>is also
available for the models created by
<code>runMetaAnalysis</code></strong>. For example, we can generate a
funnel plot for our “overall” model like this:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/guido-s/meta/" class="external-link">meta</a></span><span class="op">)</span>

<span class="co"># model.overall is a "meta" model, so we can directly</span>
<span class="co"># Apply the funnel function included in meta</span>
<span class="fu"><a href="https://rdrr.io/pkg/meta/man/funnel.meta.html" class="external-link">funnel</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">model.overall</span>, 
       studlab <span class="op">=</span> <span class="cn">TRUE</span>, 
       contour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span><span class="op">)</span>,
       col.contour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkgreen"</span>, <span class="st">"green"</span>, <span class="st">"lightgreen"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<center>
<img src="funnel.png" width="400">
</center>
<p><br></p>
<p>This feature can also be used to run, for example, <strong>Egger’s
regression test</strong>, using functions already included in
<code>meta</code> and <code>dmetar</code>:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Egger's regression test applied to the "overall" model:</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dmetar.protectlab.org" class="external-link">dmetar</a></span><span class="op">)</span>
<span class="fu"><a href="http://dmetar.protectlab.org/reference/eggers.test.html" class="external-link">eggers.test</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">model.overall</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co"># Eggers' test of the intercept </span>
<span class="co"># ============================= </span>
<span class="co"># </span>
<span class="co">#  intercept        95% CI      t           p</span>
<span class="co">#     -2.814 -3.97 - -1.66 -4.785 7.17608e-05</span>
<span class="co"># </span>
<span class="co"># Eggers' test indicates the presence of funnel plot asymmetry. </span></code></pre>
<p>For an overview of all available functionality, you can consult the
specific documentation entry for each meta-analysis model type:</p>
<ul>
<li><p><code>"overall"</code>, <code>"combined"</code>,
<code>"lowest"</code>, <code>"highest"</code>, <code>"outliers"</code>,
<code>"influence"</code>, <code>"rob"</code>: run <code><a href="https://rdrr.io/pkg/meta/man/metagen.html" class="external-link">?metagen</a></code>
in the console (if effect size if <span class="math inline">\(g\)</span>, or if if effect size is <span class="math inline">\(RR\)</span> and <code>es.type</code> is
<code>"precalculated"</code>); otherwise, run
<code><a href="https://rdrr.io/pkg/meta/man/metabin.html" class="external-link">?metabin</a></code>.</p></li>
<li><p><code>"threelevel"</code> and <code>"threelevel.che"</code>: run
<code><a href="https://wviechtb.github.io/metafor/reference/rma.mv.html" class="external-link">?rma.mv</a></code> in the console. The <a href="https://wviechtb.github.io/metafor/reference/rma.mv.html#methods-1" class="external-link">methods</a>
section in this documentation entry is particularly relevant, since it
shows functions that can be applied to this model type (so-called S3
methods).</p></li>
</ul>
<p><br></p>
</div>
<div class="section level4">
<h4 id="forest-plots">Forest Plots<a class="anchor" aria-label="anchor" href="#forest-plots"></a>
</h4>
<p>It is also possible to generate <strong>forest plots</strong> of all
the calculated models. We only have to plug the results object into
<code>plot</code>, and specify the name of the model for which the
forest plot should be retrieved:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"overall"</span><span class="op">)</span>        <span class="co"># Overall model (ES assumed independent)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"combined"</span><span class="op">)</span>       <span class="co"># ES combined within studies before pooling</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"lowest.highest"</span><span class="op">)</span> <span class="co"># Lowest and highest ES removed (creates 2 plots)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"outliers"</span><span class="op">)</span>       <span class="co"># Outliers-removed model</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"influence"</span><span class="op">)</span>      <span class="co"># Influential cases-removed model</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"threelevel"</span><span class="op">)</span>     <span class="co"># Three-level model</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"threelevel.che"</span><span class="op">)</span> <span class="co"># Three-level CHE model</span></code></pre></div>
<p>This is what the <code>"overall"</code> model forest plot looks like,
for example:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"overall"</span><span class="op">)</span></code></pre></div>
<center>
<img src="forest.png" width="400">
</center>
<p>Note that the <code>plot</code> function is simply a wrapper for the
<code>forest.meta</code> function in the <code>meta</code> package.
Therefore, all the advanced <a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/forest.html" class="external-link">styling
options</a> are also available using extra arguments.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"overall"</span>, 
     col.predict <span class="op">=</span> <span class="st">"lightgreen"</span>, 
     col.square <span class="op">=</span> <span class="st">"gray"</span>,
     fontfamily <span class="op">=</span> <span class="st">"Palatino"</span><span class="op">)</span></code></pre></div>
<center>
<img src="forest2.png" width="400">
</center>
<p>It is also possible to generate <a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/heterogeneity.html#baujat" class="external-link">Baujat</a>
and <a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/heterogeneity.html#loo-ma" class="external-link">Leave-One-Out
Plots</a> (not displayed here).</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"baujat"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"loo-es"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"loo-i2"</span><span class="op">)</span></code></pre></div>
<p><br></p>
</div>
<div class="section level4">
<h4 id="replacement-functions">Replacement Functions<a class="anchor" aria-label="anchor" href="#replacement-functions"></a>
</h4>
<p>Once a model has been fitted using <code>runMetaAnalysis</code>,
<strong>replacement functions</strong> are defined for each function
argument. This allows to quickly tweak one or more analysis settings,
which are implemented once the <code>rerun</code> function is
called.</p>
<p>If, for example, we want to check the results using a different
estimator of <span class="math inline">\(\tau^2\)</span>, and a
different CER to calculate the number needed to treat, leaving all other
settings the same, we can run:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/Replacement-functions.html">method.tau</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"PM"</span>
<span class="fu"><a href="../reference/Replacement-functions.html">nnt.cer</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></code></pre></div>
<p>Then, we have to call the <code>rerun</code> function:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/Replacement-functions.html">rerun</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></code></pre></div>
<p>A list of all available setting replacement functions is provided <a href="https://tools.metapsy.org/reference/replacement-functions" class="external-link">here</a>.</p>
<p><br></p>
</div>
</div>
<div class="section level3">
<h3 id="publication-bias">Publication Bias<a class="anchor" aria-label="anchor" href="#publication-bias"></a>
</h3>
<p>It is also possible to correct effect size estimates for potential
publication bias and/or small-study effects using the <a href="https://tools.metapsy.org/reference/correctpublicationbias" class="external-link"><code>correctPublicationBias</code></a>
function. This will apply three correction methods at the same time,
providing a range of (more or less) plausible corrected values. Using
the <code>which.run</code> argument, we can apply these methods to the
<code>"combined"</code> analysis.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/correctPublicationBias.html">correctPublicationBias</a></span><span class="op">(</span><span class="va">res</span>, which.run <span class="op">=</span> <span class="st">"combined"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co"># [...]</span>
<span class="co"># Publication bias correction ('combined' model) ----------------------- </span>
<span class="co"># Model                    k     g g.ci           p         i2 i2.ci          prediction.ci   nnt</span>
<span class="co"># Trim-and-fill method    24 -0.16 [-0.62; 0.31]  0.490   85.4 [79.41; 89.61] [-2.16; 1.85] 24.4 </span>
<span class="co"># Limit meta-analysis     17  0.1  [-0.32; 0.52]  0.649   95.1 -              [-1.05; 1.25] 35.4 </span>
<span class="co"># Selection model         17 -0.87 [-1.38; -0.36] &lt;0.001  85.7 [64.72; 94.57] [-1.98; 0.24]  6.38</span>
<span class="co"># [...]</span></code></pre>
<p>The reason why three publication bias methods are applied at the same
time is because all publication bias methods are based on (to some
extent) <strong>untestable</strong> <strong>assumptions</strong>, and
these assumption differ between methods:</p>
<ul>
<li><p>The <strong>trim-and-fill</strong> method is included mostly as a
“legacy” method, given its popularity in the last decades. This method
is also frequently requested by reviewers. However, it has been found
that this method does not perform well as a method to correct for
publication bias, especially when the between-study heterogeneity is
high. The trim-and-fill method assumes that publication bias results in
funnel plot asymmetry, and provides an algorithm that imputes studies so
that this asymmetry is removed, after which the results are
re-estimated.</p></li>
<li><p>The <strong>limit meta-analysis</strong> method assumes that
publication bias manifests itself in so-called small-study effects
(i.e., it assumes that small studies with high standard errors are more
likely to be affected by publication bias). It calculates the expected
(“shrunken”) pooled effect as the standard error <span class="math inline">\(\epsilon_k\)</span> goes to zero, while accounting
for between-study heterogeneity. Importantly, this methods controls for
small-study effects only, which can be associated with publication bias,
but does not have to.</p></li>
<li><p>Lastly, a <strong>step function selection model</strong> is
calculated, which allows to account for the possibility that results are
more or less likely to get published depending on their <span class="math inline">\(P\)</span> value. By default, the
<code>selmodel.steps</code> argument is set to 0.05, which means that we
assume that results with <span class="math inline">\(p\)</span>&lt;0.1
are more likely to get published. It is also possible to define more
than one selection threshold, e.g. by setting
<code>selmodel.steps</code> to <code>c(0.025, 0.05)</code>.</p></li>
</ul>
<p>For further details, see Harrer, Cuijpers, Furukawa &amp; Ebert
(2022, chap. <a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/pub-bias.html#pub-bias-which-method" class="external-link">9.3</a>).</p>
<p>The <code>correctPublicationBias</code> function also allows to
provide additional arguments that will be applied if they match the ones
defined in the <a href="https://rdrr.io/cran/meta/man/trimfill.html" class="external-link"><code>trimfill</code></a>
and <a href="https://rdrr.io/cran/metasens/man/limitmeta.html" class="external-link"><code>limitmeta</code></a>
functions in <code>meta</code> and <code>metasens</code> (Schwarzer,
Carpenter &amp; Rücker, <a href="https://CRAN.R-project.org/package=metasens" class="external-link">2022</a>),
respectively. You can find an example below:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/correctPublicationBias.html">correctPublicationBias</a></span><span class="op">(</span>
  
              <span class="va">res</span>, which.run <span class="op">=</span> <span class="st">"combined"</span>,
              
              <span class="co"># Use the R-type estimator to trim &amp; fill</span>
              type <span class="op">=</span> <span class="st">"R"</span>,
              
              <span class="co"># Use a random-effects model without bias parameter</span>
              <span class="co"># to shrink effects in the limi meta-analysis</span>
              method.adjust <span class="op">=</span> <span class="st">"mulim"</span><span class="op">)</span> </code></pre></div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="subgroup-analysis">Subgroup Analysis<a class="anchor" aria-label="anchor" href="#subgroup-analysis"></a>
</h3>
<p>The <code>subgroupAnalysis</code> function can be used to perform
subgroup analyses. Every column included in the data set initially
supplied to <code>runMetaAnalysis</code> can be used as a subgroup
variable.</p>
<p>For example, we might want to check if effects differ by country
(<code>country</code>) or intervention type
(<code>condition_arm1</code>):</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subgroupAnalysis.html">subgroupAnalysis</a></span><span class="op">(</span><span class="va">res</span>, <span class="va">country</span>, <span class="va">condition_arm2</span><span class="op">)</span>
<span class="va">sg</span></code></pre></div>
<pre><code><span class="co"># Subgroup analysis results ---------------------- </span>
<span class="co"># variable       group n.comp     g g.ci              i2 i2.ci        nnt   p    </span>
<span class="co"># country        3         13 -0.61 [-1.3; 0.07]    81.5 [69.5; 88.8] 4.80  0.666</span>
<span class="co"># .              1         13 -0.76 [-0.93; -0.58]   0   [0; 56.6]    3.74  .    </span>
<span class="co"># condition_arm2 cau       12 -0.32 [-0.54; -0.09]  71.9 [49.6; 84.3] 9.90  0.025</span>
<span class="co"># .              wl        14 -0.96 [-1.54; -0.38]  70.6 [49.4; 83]   2.88  .  </span></code></pre>
<p>By default, an HTML table should also pop up. The <code>p</code>
column to the right represents the significance of the overall subgroup
effect (there is, for example, no significant moderator effect of
<code>country</code>).</p>
<p>It is also possible to conduct subgroup analyses using another model,
say, the three-level model. We only have to specify
<code>.which.run</code>:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subgroupAnalysis.html">subgroupAnalysis</a></span><span class="op">(</span><span class="va">res</span>, 
                       <span class="va">country</span>, <span class="va">condition_arm2</span>,
                       .which.run <span class="op">=</span> <span class="st">"threelevel"</span><span class="op">)</span></code></pre></div>
<p>When the number of studies in subgroups are small, it is sensible to
use a <strong>common estimate</strong> of the between-study
heterogeneity variance <span class="math inline">\(\tau^2\)</span> (in
lieu of subgroup-specific estimates). This can be done by setting the
<code>.tau.common</code> argument to <code>TRUE</code> in the
function:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subgroupAnalysis.html">subgroupAnalysis</a></span><span class="op">(</span><span class="va">res</span>, 
                       <span class="va">country</span>, <span class="va">condition_arm2</span>,
                       .which.run <span class="op">=</span> <span class="st">"combined"</span>,
                       .tau.common <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="meta-regression">Meta-Regression<a class="anchor" aria-label="anchor" href="#meta-regression"></a>
</h3>
<p>Since the <code>runMetaAnalysis</code> function saves all fitted
models internally, it is also possible to extract each of them
individually to do further computations. Say, for example, that we want
to perform multiple meta-regression using our <code>threelevel</code>
model. We want to use the risk of bias rating, as well as the scaled
study year as predictors. This can be achieved by extracting the model
to be analyzed using the <code>$</code> operator, and then using
<code>metaRegression</code> to fit the model.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/metaRegression.html">metaRegression</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">model.threelevel</span>, 
               <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">rob</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co"># Multivariate Meta-Analysis Model (k = 26; method: REML)</span>
<span class="co"># </span>
<span class="co"># Variance Components:</span>
<span class="co"># </span>
<span class="co">#             estim    sqrt  nlvls  fixed       factor </span>
<span class="co"># sigma^2.1  0.3821  0.6181     14     no        study </span>
<span class="co"># sigma^2.2  0.0000  0.0000     26     no  study/es.id </span>
<span class="co"># </span>
<span class="co"># Test for Residual Heterogeneity:</span>
<span class="co"># QE(df = 23) = 64.6042, p-val &lt; .0001</span>
<span class="co"># </span>
<span class="co"># Test of Moderators (coefficients 2:3):</span>
<span class="co"># F(df1 = 2, df2 = 23) = 3.0051, p-val = 0.0693</span>
<span class="co"># </span>
<span class="co"># Model Results:</span>
<span class="co"># </span>
<span class="co">#                         estimate      se     tval  df    pval    ci.lb    ci.ub     </span>
<span class="co"># intrcpt                  -0.6999  0.1923  -3.6394  23  0.0014  -1.0978  -0.3021  ** </span>
<span class="co"># scale(as.numeric(rob))    0.5538  0.2364   2.3428  23  0.0282   0.0648   1.0428   * </span>
<span class="co"># scale(year)              -0.2656  0.2827  -0.9395  23  0.3572  -0.8503   0.3192     </span>
<span class="co"># </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></code></pre>
<p><br></p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="study-tables">
<img src="https://tools.metapsy.org/figures/table.svg" width="30px" style="padding-right: 5px;">
Study Tables<a class="anchor" aria-label="anchor" href="#study-tables"></a>
</h2>
<hr>
<p>The <code>createStudyTable</code> function allows to create an
overview table for the included studies/comparisons. One only has to
supply the filtered data set first, and then the names of the desired
variables in the order in which they should appear in the table. It is
also possible to rename factor labels directly in the function,
determine how far values should be rounded, and if variable names should
be changed:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/createStudyTable.html">createStudyTable</a></span><span class="op">(</span>
  
  <span class="co"># Dataset. Alternatively, a runMetaAnalysis</span>
  <span class="co"># object can also be used.</span>
  <span class="va">ma.data</span>,
                 
  <span class="co">## Columns --------------------------------------</span>
  <span class="co"># Simply add columns in the order in which</span>
  <span class="co"># they should appear in the table</span>
  <span class="va">study</span>, <span class="va">age_group</span>, <span class="va">mean_age</span>, <span class="va">percent_women</span>,
  
  <span class="co"># You can directly recode values within a variable</span>
  condition_arm1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CBT"</span> <span class="op">=</span> <span class="st">"cbt"</span><span class="op">)</span>, 
  <span class="va">multi_arm1</span>,
  condition_arm2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wait-List"</span> <span class="op">=</span> <span class="st">"wl"</span>, 
                     <span class="st">"Care-As-Usual"</span> <span class="op">=</span> <span class="st">"cau"</span><span class="op">)</span>,
  <span class="va">n_arm1</span>, <span class="va">n_arm2</span>, 
  country <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Europe"</span> <span class="op">=</span> <span class="st">"3"</span>, <span class="st">"USA"</span> <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span>,
  <span class="va">sg</span>, <span class="va">ac</span>, <span class="va">itt</span>,
  
  
  <span class="co">## Specifications -------------------------------</span>
  <span class="co"># .round.by.digits controls the number of rounded digits for</span>
  <span class="co"># specified columns</span>
  .round.by.digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean_age <span class="op">=</span> <span class="fl">0</span>, 
                          n_arm1 <span class="op">=</span> <span class="fl">0</span>,
                          n_arm2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
  
  <span class="co"># .column.names allows to rename columns</span>
  .column.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>age_group <span class="op">=</span> <span class="st">"age group"</span>,
                       mean_age <span class="op">=</span> <span class="st">"mean age"</span>,
                       percent_women <span class="op">=</span> <span class="st">"% female"</span>,
                       condition_arm1 <span class="op">=</span> <span class="st">"Intervention"</span>,
                       condition_arm2 <span class="op">=</span> <span class="st">"Control"</span>,
                       n_arm1 <span class="op">=</span> <span class="st">"N (IG)"</span>, 
                       n_arm2 <span class="op">=</span> <span class="st">"N (CG)"</span>,
                       multi_arm1 <span class="op">=</span> <span class="st">"Specification"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>By default, <code>createStudyTable</code> also returns an HTML table
that one can copy and paste into MS Word.</p>
<iframe src="https://tools.metapsy.org/figures/tbl2.html" style="width: 100%; height: 750px;">
</iframe>
<p><br></p>
<div style="background-color: #f1f3f5 !important; padding: 25px; border-radius: 5px; color: gray; box-shadow: 0px 0px 5px;">
<p><strong>Still have questions?</strong> This vignette only provides a
superficial overview of <code>metapsyTools</code>’ functionality. Every
function also comes with a detailed documentation, which you may consult
to learn more about available options and covered use cases. Please note
that <code>metapsyTools</code> is still at an early development stage,
which means that errors or other problems may still occur under some
circumstances. To report an issue or ask for help, you can contact
<strong>Mathias</strong> (<a href="mailto:mathias.harrer@tum.de" class="email">mathias.harrer@tum.de</a>).</p>
</div>
<p><br></p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>CBT vs. PST, CBT vs. CAU, CBT vs. Waitlist, PST vs. CAU,
PST vs. Waitlist, and CAU vs. Waitlist. You can also confirm this by
running: <code>combn(c("cbt", "pst", "cau", "wl"), 2)</code>. Please
note that not all possible combinations will be included in all Metapsy
data set (e.g., the CAU-Waitlist combination in our example may
typically not be included).<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>These functions are technically part of the <a href="https://tools.metapsy.org/reference/#preparation-module" class="external-link">preparation
module</a>, but are listed here for convenience.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>The <span class="math inline">\(G^2\)</span> statistic
(<a href="https://academic.oup.com/biostatistics/article/12/1/122/391113" class="external-link">Rücker
et al., 2011</a>) quanitifies the percentage of between-study
heterogeneity that remains after small-study effects have been accounted
for (in <code>metapsyTools</code>, <span class="math inline">\(G^2\)</span> is printed as <span class="math inline">\(I^2\)</span> ).<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Mathias Harrer, Paula Kuper, Antonia Sprenger, Pim
Cuijpers.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
</div>

    </footer>
</div>

  

  <script src="extra_script.js"></script>
</body>
</html>
