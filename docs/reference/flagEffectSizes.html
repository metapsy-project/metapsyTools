<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function flags effect sizes that are too extreme and/or implausible to merit inclusion in
meta-analytic models. Effect sizes are flagged based the size of the effect, achieved power, and study quality.
"><title>Flag extreme and/or implausible effect sizes — flagEffectSizes • metapsyTools</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Sans-0.4.7/font.css" rel="stylesheet"><link href="../deps/Fira_Code-0.4.7/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.7/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Flag extreme and/or implausible effect sizes — flagEffectSizes"><meta property="og:description" content="This function flags effect sizes that are too extreme and/or implausible to merit inclusion in
meta-analytic models. Effect sizes are flagged based the size of the effect, achieved power, and study quality.
"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script src="extra_script_header.js"></script></head><body><p>,<link rel="stylesheet" href="extra.css"></p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metapsyTools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.13</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/web/get-started.html">Get Started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tools">Tools</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tools">
    <a class="dropdown-item" href="../reference/index.html">Function Reference</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/web/installation.html">Installation Guide</a>
    <a class="dropdown-item" href="../articles/web/look_inside.html">A Look Inside</a>
    <a class="dropdown-item" href="../data-validator.html">Data Validator</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/metapsy-project/metapsyTools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Flag extreme and/or implausible effect sizes</h1>
      <small class="dont-index">Source: <a href="https://github.com/metapsy-project/metapsyTools/blob/HEAD/R/flagEffectSizes.R" class="external-link"><code>R/flagEffectSizes.R</code></a></small>
      <div class="d-none name"><code>flagEffectSizes.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function flags effect sizes that are too extreme and/or implausible to merit inclusion in
meta-analytic models. Effect sizes are flagged based the size of the effect, achieved power, and study quality.
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">flagEffectSizes</span><span class="op">(</span><span class="va">data</span>, </span>
<span>                es.var <span class="op">=</span> <span class="st">".g"</span>, </span>
<span>                se.var <span class="op">=</span> <span class="st">".g_se"</span>,</span>
<span>                high.rob.filter <span class="op">=</span> <span class="st">"rob &lt;= 2"</span>, </span>
<span>                power <span class="op">=</span> <span class="st">"reference"</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>                reference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"dep"</span>, <span class="st">"psy"</span>, <span class="st">"ptsd"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A <code>data.frame</code>, including effect size data following the
<a href="https://docs.metapsy.org/data-preparation/format/" class="external-link">Metapsy data standard</a>, as
created by <code><a href="calculateEffectSizes.html">calculateEffectSizes()</a></code>.</p></dd>


<dt>es.var</dt>
<dd><p>A <code>character</code>, specifying the name of the variable containing the (pre-calculated)
effect sizes in <code>data</code>. Defaults to <code>".g"</code>.</p></dd>


<dt>se.var</dt>
<dd><p>A <code>character</code>, specifying the name of the variable containing the
standard errors (square root of the variance) in <code>data</code>. Defaults to <code>".g_se"</code>.</p></dd>


<dt>high.rob.filter</dt>
<dd><p>A <code>character</code>, including a filtering statement by which to
include studies with high risk of bias/low study quality. Please note that the name of
the variable must be included as a column in <code>data</code>.</p></dd>


<dt>power</dt>
<dd><p>Reference value for defining a "strongly" underpowered study (<em></em>\(1-\beta\)).
Defaults to <code>"reference"</code>, which corresponds to the first quartile of a
reference power distribution derived from a large-scale meta-analytic
database of psychological treatments (see Details). Also accepts user-defined
power threshold in the (0,1) range (e.g., <code>power = 0.8</code> for 80% power).</p></dd>


<dt>alpha</dt>
<dd><p>The <em></em>\(\alpha\) level used to determine "incompatibility" of an effect size (0.05 by default). See Details.</p></dd>


<dt>reference</dt>
<dd><p>A <code>character</code> value, indicating the specific disorder for which reference values should be used.
Defaults to <code>"all"</code>, meaning that the reference values across all included disorders are used. Other supported
values are <code>"dep"</code> (depression), <code>"psy"</code> (psychosis), and <code>"ptsd"</code> (PTSD). To improve calibration,
the <code>"psy"</code> reference values may also be used for fields in which low effect sizes are more common,
or <code>"ptsd"</code> in high-effect size fields.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns an object of class <code>flagEffectSizes</code>, with the following elements:</p>


<ul><li><p><code>smd</code>. The provided effect sizes.</p></li>
<li><p><code>se</code>. The provided standard errors of the effect size.</p></li>
<li><p><code>flag.effect</code>. A logical, indicating if the effect was flagged for the first criterion (incompatible effect size).</p></li>
<li><p><code>flag.power</code>. A logical, indicating if the effect was flagged for the second criterion (strongly underpowered).</p></li>
<li><p><code>flag.rob</code>. A logical, indicating if the effect was flagged for the third criterion (risk of bias/low quality).</p></li>
<li><p><code>flags</code>. The numeric, indicating the number of flags for each effect size (0-3).</p></li>
<li><p><code>lookup</code>. A data frame, showing the empirical reference values that were used for the computations. Includes the
name of the reference effect size distribution (<code>distname</code>) and its parameters, the reference effect size based on
which power is determined (<code>mu.fe</code>), as well as the first quartile of power in the reference sample (<code>q1.pwr</code>)</p></li>
<li><p><code>data</code>. The original data.frame provided in <code>data</code>.</p></li>
</ul><p>Returned objects can be directly analyzed using <code><a href="runMetaAnalysis.html">runMetaAnalysis()</a></code>, which will then
remove flagged studies (3 flags) during the computation.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This flagging tool is based on a meta-epidemiological study of &gt;2,000 effect
sizes from the Metapsy databases, covering psychological treatment trials across
12 mental health problems (depression, generalized anxiety, social anxiety,
specific phobia, panic disorder, obsessive-compulsive disorder, PTSD, complicated grief,
psychosis, suicidality). Based on this database, three indicators are
used to flag trials:</p>
<ul><li><p><strong>Extreme effect sizes</strong>: A set of candidate parametric distributions
(Pareto, exponential, Cauchy, Gamma, logistic, log-normal, and Weibull) was fitted
to effect sizes from low risk-of-bias trials with inactive control groups in the Metapsy databases.
The best-fitting distribution was then selected. Effect sizes are flagged if they exceeded a critical threshold
corresponding to a Shannon information value (S-value) of 4.32,
roughly equating to the improbability of four heads in a row, or
\(p\) = 0.05.</p></li>
<li><p><strong>Strong lack of power</strong>: Each study's achieved statistical
power is computed relative to a bias-corrected reference effect size
estimated from low risk-of-bias trials (see <code>mu.fe</code> in the <code>lookup</code> element returned by the function). Instead of
using the conventional 80% threshold, trials are flagged by default if their power
falls in the lowest empirical quartile of this empirical distribution (<code>power = "reference"</code>).
Thus, by default, only the most severely underpowered trials are flagged.</p></li>
<li><p><strong>Risk of bias / low study quality</strong>: Trials not judged as "low risk"
(e.g. according to Cochrane's Risk of Bias tool) are flagged.</p></li>
</ul><p>For each effect size, the three indicators are summed (0–3 flags). Effects showing
all three risk indicators are considered highly implausible and may be
excluded by default from meta-analytic models. This is the default behavior if results
of <code>flagEffectSizes</code> are forwarded directly to <code><a href="runMetaAnalysis.html">runMetaAnalysis()</a></code>.
Reference values can be applied across all mental health problems (<code>"all"</code>), or calibrated to specific
fields (<code>"dep"</code> = depression, <code>"psy"</code> = psychosis, <code>"ptsd"</code> = PTSD), depending on
the user's selection for the <code>reference</code> argument. To improve calibration,
the <code>"psy"</code> reference values may also be used for fields in which low effect sizes are more common,
or <code>"ptsd"</code> in high-effect size fields.</p>
<p>The development and performance of the flagging tool is described in greated detail in Harrer et al. (2025).
Please note that reference values may change over time as the tool is updated using new
versions of the living databases. Exact reference values and distributions
used for the calculations will always be provided in the <code>lookup</code> data frame returned by the function.</p>
<p>For more details on the metapsyTools package, see the <a href="https://tools.metapsy.org/articles/metapsytools" class="external-link">Get Started</a> vignette.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Mathias Harrer <a href="mailto:mathias.h.harrer@gmail.com">mathias.h.harrer@gmail.com</a>,
Pim Cuijpers <a href="mailto:p.cuijpers@vu.nl">p.cuijpers@vu.nl</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="Replacement-functions.html">data</a></span><span class="op">(</span><span class="st">"depressionPsyCtr"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use as part of a meta-analysis pipeline</span></span></span>
<span class="r-in"><span><span class="co"># Flagged studies are excluded</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="checkDataFormat.html">checkDataFormat</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="calculateEffectSizes.html">calculateEffectSizes</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="filterPoolingData.html">filterPoolingData</a></span><span class="op">(</span><span class="va">condition_arm1</span> <span class="op">==</span> <span class="st">"cbt"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu">flagEffectSizes</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="runMetaAnalysis.html">runMetaAnalysis</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use depression-specific reference values</span></span></span>
<span class="r-in"><span><span class="va">fe</span> <span class="op">=</span> <span class="fu">flagEffectSizes</span><span class="op">(</span><span class="va">data</span>, reference <span class="op">=</span> <span class="st">"dep"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show results and used reference values</span></span></span>
<span class="r-in"><span><span class="va">fe</span></span></span>
<span class="r-in"><span><span class="va">fe</span><span class="op">$</span><span class="va">lookup</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a plot of the empirical effects &amp; </span></span></span>
<span class="r-in"><span><span class="co"># reference distribution</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fe</span>, breaks <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Append number of flags to original data</span></span></span>
<span class="r-in"><span><span class="co"># Then use in meta-regression and subgroup analysis</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">flags</span> <span class="op">=</span> <span class="va">fe</span><span class="op">$</span><span class="va">flags</span></span></span>
<span class="r-in"><span><span class="va">M</span> <span class="op">=</span> <span class="fu"><a href="runMetaAnalysis.html">runMetaAnalysis</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="metaRegression.html">metaRegression</a></span><span class="op">(</span><span class="va">M</span><span class="op">$</span><span class="va">model.overall</span>, <span class="op">~</span> <span class="va">flags</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="subgroupAnalysis.html">subgroupAnalysis</a></span><span class="op">(</span><span class="va">M</span>, <span class="va">flags</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Mathias Harrer, Paula Kuper, Antonia Sprenger, Pim Cuijpers.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
</div>

    </footer></div>

  

  <script src="extra_script.js"></script></body></html>

